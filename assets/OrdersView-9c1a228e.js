import{M as $}from"./bootstrap.esm-434bcbc7.js";import{_ as O,o as d,c as s,a as e,t as o,i as m,F as u,g as b,w as M,h as g,f,r as k,b as v,n as x}from"./index-3d2be7b2.js";const V={props:["temp-Order","updatePaid"]},A={class:"modal-dialog modal-xl",role:"document"},D={class:"modal-content border-0"},E=e("div",{class:"modal-header bg-dark text-white"},[e("h5",{class:"modal-title",id:"exampleModalLabel"},[e("span",null,"訂單細節")]),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),L={class:"modal-body"},S={class:"row"},T={class:"col-md-4"},U=e("h3",null,"用戶資料",-1),q={class:"table"},B={key:0},I=e("th",{style:{width:"100px"}},"姓名",-1),N=e("th",null,"Email",-1),R=e("th",null,"電話",-1),F=e("th",null,"地址",-1),H={class:"col-md-8"},j=e("h3",null,"訂單細節",-1),z={class:"table"},G=e("th",{style:{width:"100px"}},"訂單編號",-1),J=e("th",null,"下單時間",-1),K=e("th",null,"付款時間",-1),Q={key:0},W={key:1},X=e("th",null,"付款狀態",-1),Y={key:0,class:"text-success"},Z={key:1,class:"text-muted"},ee=e("th",null,"總金額",-1),te=e("h3",null,"選購商品",-1),de={class:"table"},se=e("thead",null,[e("tr")],-1),oe={class:"text-end"},le={class:"d-flex justify-content-end"},re={class:"form-check"},ne={class:"form-check-label",for:"flexCheckDefault"},ae={key:0},ie={key:1},ce={class:"modal-footer"},he=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function ue(t,n,i,y,h,c){return d(),s("div",A,[e("div",D,[E,e("div",L,[e("div",S,[e("div",T,[U,e("table",q,[t.tempOrder.user?(d(),s("tbody",B,[e("tr",null,[I,e("td",null,o(t.tempOrder.user.name),1)]),e("tr",null,[N,e("td",null,o(t.tempOrder.user.email),1)]),e("tr",null,[R,e("td",null,o(t.tempOrder.user.tel),1)]),e("tr",null,[F,e("td",null,o(t.tempOrder.user.address),1)])])):m("",!0)])]),e("div",H,[j,e("table",z,[e("tbody",null,[e("tr",null,[G,e("td",null,o(t.tempOrder.id),1)]),e("tr",null,[J,e("td",null,o(t.tempOrder.create_at),1)]),e("tr",null,[K,e("td",null,[t.tempOrder.paid_date?(d(),s("span",Q,o(t.tempOrder.paid_date),1)):(d(),s("span",W,"時間不正確"))])]),e("tr",null,[X,e("td",null,[t.tempOrder.is_paid?(d(),s("strong",Y,"已付款")):(d(),s("span",Z,"尚未付款"))])]),e("tr",null,[ee,e("td",null,o(t.tempOrder.total),1)])])]),te,e("table",de,[se,e("tbody",null,[(d(!0),s(u,null,b(t.tempOrder.products,r=>(d(),s("tr",{key:r.id},[e("th",null,o(r.product.title),1),e("td",null,o(r.qty)+" / "+o(r.product.unit),1),e("td",oe,o(r.final_total),1)]))),128))])]),e("div",le,[e("div",re,[M(e("input",{class:"form-check-input",type:"checkbox",value:"",id:"flexCheckDefault","onUpdate:modelValue":n[0]||(n[0]=r=>t.tempOrder.is_paid=r)},null,512),[[g,t.tempOrder.is_paid]]),e("label",ne,[t.tempOrder.is_paid?(d(),s("span",ae,"已付款")):(d(),s("span",ie,"未付款"))])])])])])]),e("div",ce,[he,e("button",{type:"button",class:"btn btn-primary",onClick:n[1]||(n[1]=(...r)=>i.updatePaid&&i.updatePaid(...r))}," 修改付款狀態 ")])])])}const _e=O(V,[["render",ue]]),pe={props:["temp-Order","delete-Order"]},me={class:"modal-dialog"},be={class:"modal-content border-0"},Oe=e("div",{class:"modal-header bg-danger text-white"},[e("h5",{id:"delOrderModalLabel",class:"modal-title"},[e("span",null,"刪除訂單")]),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),ye={class:"modal-body"},$e={class:"text-danger"},fe={class:"modal-footer"},ke=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function ve(t,n,i,y,h,c){return d(),s("div",me,[e("div",be,[Oe,e("div",ye,[f(" 是否刪除 "),e("strong",$e,o(t.tempOrder.title),1),f(" 訂單(刪除後將無法恢復)。 ")]),e("div",fe,[ke,e("button",{type:"button",class:"btn btn-danger",onClick:n[0]||(n[0]=(...r)=>t.deleteOrder&&t.deleteOrder(...r))}," 確認刪除 ")])])])}const Me=O(pe,[["render",ve]]),{VITE_APP_URL:_,VITE_APP_PATH:p}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"silvia-hexschool",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0},ge={data(){return{orders:{},tempOrder:{},orderModal:{},delOrderModal:{}}},components:{OrderModal:_e,DelOrderModal:Me},methods:{getAllOrders(){this.$http.get(`${_}/api/${p}/admin/orders`).then(t=>{this.orders=t.data.orders}).catch(t=>{console.log(t)})},deleteOrder(){this.$http.delete(`${_}/api/${p}/admin/order/${this.tempOrder.id}`).then(t=>{this.delOrderModal.hide(),this.getAllOrders()}).catch(t=>{console.log(t)})},updatePaid(){const t=`${_}/api/${p}/admin/order/${this.tempOrder.id}`,n={is_paid:this.tempOrder.is_paid};this.$http.put(t,{data:n}).then(i=>{this.getAllOrders(),this.orderModal.hide()}).catch(i=>{this.$httpMessageState(i.response,"錯誤訊息")})},hide(){this.orderModal.hide()},openModal(t){this.tempOrder={...t},this.orderModal=new $(document.querySelector("#orderModal")),this.orderModal.show()},openDelOrderModal(t){this.tempOrder={...t},this.delOrderModal=new $(document.querySelector("#delOrderModal")),this.delOrderModal.show()}},mounted(){this.getAllOrders()}},Ce={class:"table mt-4"},Pe=e("thead",null,[e("tr",null,[e("th",null,"購買時間"),e("th",null,"Email"),e("th",null,"購買款項"),e("th",null,"應付金額"),e("th",null,"是否付款"),e("th",null,"編輯")])],-1),we=["textContent"],xe={class:"list-unstyled"},Ve={class:"text-right"},Ae={class:"form-check form-switch"},De=["id","onUpdate:modelValue","onChange"],Ee=["for"],Le={key:0},Se={key:1},Te={class:"btn-group"},Ue=["onClick"],qe=["onClick"],Be={class:"modal fade",id:"orderModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Ie={id:"delOrderModal",ref:"delOrderModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delOrderModalLabel","aria-hidden":"true"};function Ne(t,n,i,y,h,c){const r=k("order-modal"),C=k("del-order-modal");return d(),s(u,null,[e("table",Ce,[Pe,e("tbody",null,[(d(!0),s(u,null,b(h.orders,(l,P)=>(d(),s(u,{key:P},[h.orders.length?(d(),s("tr",{key:0,class:x({"text-secondary":!l.is_paid})},[e("td",null,o(l.create_at),1),e("td",null,[l.user?(d(),s("span",{key:0,textContent:o(l.user.email)},null,8,we)):m("",!0)]),e("td",null,[e("ul",xe,[(d(!0),s(u,null,b(l.products,(a,w)=>(d(),s("li",{key:w},o(a.product.title)+" 數量："+o(a.qty)+" "+o(a.product.unit),1))),128))])]),e("td",Ve,o(l.total),1),e("td",null,[e("div",Ae,[M(e("input",{class:"form-check-input",type:"checkbox",id:`paidSwitch${l.id}`,"onUpdate:modelValue":a=>l.is_paid=a,onChange:a=>c.updatePaid(l)},null,40,De),[[g,l.is_paid]]),e("label",{class:"form-check-label",for:`paidSwitch${l.id}`},[l.is_paid?(d(),s("span",Le,"已付款")):(d(),s("span",Se,"未付款"))],8,Ee)])]),e("td",null,[e("div",Te,[e("button",{class:"btn btn-outline-primary btn-sm",type:"button",onClick:a=>c.openModal(l)}," 檢視 ",8,Ue),e("button",{class:"btn btn-outline-danger btn-sm",type:"button",onClick:a=>c.openDelOrderModal(l)}," 刪除 ",8,qe)])])],2)):m("",!0)],64))),128))])]),e("div",Be,[v(r,{"temp-order":h.tempOrder,"update-paid":c.updatePaid},null,8,["temp-order","update-paid"])]),e("div",Ie,[v(C,{"temp-order":h.tempOrder,"delete-order":c.deleteOrder},null,8,["temp-order","delete-order"])],512)],64)}const He=O(ge,[["render",Ne]]);export{He as default};
