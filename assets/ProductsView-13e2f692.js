import{M as g}from"./bootstrap.esm-434bcbc7.js";import{_ as b,o as d,c as l,a as t,w as n,v as a,F as y,g as M,h as U,f,t as h,r as v,b as $}from"./index-3d2be7b2.js";const w={props:["temp-Product","saveProduct","isNew"]},V={class:"modal-dialog modal-xl"},A={class:"modal-content border-0"},C={class:"modal-header bg-dark text-white"},N={id:"productModalLabel",class:"modal-title"},L={key:0},T={key:1},D=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),E={class:"modal-body"},B={class:"row"},I={class:"col-sm-4"},R={class:"mb-2"},S={class:"mb-3"},q=t("label",{for:"imageUrl",class:"form-label"},"輸入圖片網址",-1),F=["src"],H=t("h3",{class:"mb-3"},"多圖新增",-1),O={class:"mb-3"},x=t("label",{for:"imageUrl",class:"form-label"},"圖片網址",-1),z=["onUpdate:modelValue"],j=["src"],G={key:0},J={key:1},K={class:"col-sm-8"},Q={class:"mb-3"},W=t("label",{for:"title",class:"form-label"},"標題",-1),X={class:"row"},Y={class:"mb-3 col-md-6"},Z=t("label",{for:"category",class:"form-label"},"分類",-1),tt={class:"mb-3 col-md-6"},ot=t("label",{for:"price",class:"form-label"},"單位",-1),et={class:"row"},st={class:"mb-3 col-md-6"},dt=t("label",{for:"origin_price",class:"form-label"},"原價",-1),lt={class:"mb-3 col-md-6"},it=t("label",{for:"price",class:"form-label"},"售價",-1),nt=t("hr",null,null,-1),at={class:"mb-3"},ct=t("label",{for:"description",class:"form-label"},"產品描述",-1),rt={class:"mb-3"},ut=t("label",{for:"content",class:"form-label"},"說明內容",-1),pt={class:"mb-3"},mt={class:"form-check"},ht=t("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),_t={class:"modal-footer"},bt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Pt(o,e,c,P,u,r){return d(),l("div",V,[t("div",A,[t("div",C,[t("h5",N,[c.isNew?(d(),l("span",L,"新增產品")):(d(),l("span",T,"編輯產品"))]),D]),t("div",E,[t("div",B,[t("div",I,[t("div",R,[t("div",S,[q,n(t("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":e[0]||(e[0]=s=>o.tempProduct.imageUrl=s)},null,512),[[a,o.tempProduct.imageUrl]])]),t("img",{class:"img-fluid",src:o.tempProduct.imageUrl,alt:""},null,8,F)]),H,t("div",null,[(d(!0),l(y,null,M(o.tempProduct.imagesUrl,(s,p)=>(d(),l("div",{class:"mb-1",key:p},[t("div",O,[x,n(t("input",{type:"text",class:"form-control","onUpdate:modelValue":i=>o.tempProduct.imagesUrl[p]=i,placeholder:"請輸入圖片連結"},null,8,z),[[a,o.tempProduct.imagesUrl[p]]])]),t("img",{class:"img-fluid",src:o.tempProduct.imagesUrl[p]},null,8,j)]))),128)),!o.tempProduct.imagesUrl||!o.tempProduct.imagesUrl.length||o.tempProduct.imagesUrl[o.tempProduct.imagesUrl.length-1]?(d(),l("div",G,[t("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[1]||(e[1]=s=>{o.tempProduct.imagesUrl.push("")})}," 新增圖片 ")])):(d(),l("div",J,[t("button",{class:"btn btn-outline-danger btn-sm d-block w-100",onClick:e[2]||(e[2]=s=>{o.tempProduct.imagesUrl.pop("")})}," 刪除圖片 ")]))])]),t("div",K,[t("div",Q,[W,n(t("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":e[3]||(e[3]=s=>o.tempProduct.title=s)},null,512),[[a,o.tempProduct.title]])]),t("div",X,[t("div",Y,[Z,n(t("input",{id:"category",type:"text",class:"form-control",placeholder:"請輸入分類","onUpdate:modelValue":e[4]||(e[4]=s=>o.tempProduct.category=s)},null,512),[[a,o.tempProduct.category]])]),t("div",tt,[ot,n(t("input",{id:"unit",type:"text",class:"form-control",placeholder:"請輸入單位","onUpdate:modelValue":e[5]||(e[5]=s=>o.tempProduct.unit=s)},null,512),[[a,o.tempProduct.unit]])])]),t("div",et,[t("div",st,[dt,n(t("input",{id:"origin_price",type:"number",min:"0",class:"form-control",placeholder:"請輸入原價","onUpdate:modelValue":e[6]||(e[6]=s=>o.tempProduct.origin_price=s)},null,512),[[a,o.tempProduct.origin_price]])]),t("div",lt,[it,n(t("input",{id:"price",type:"number",min:"0",class:"form-control",placeholder:"請輸入售價","onUpdate:modelValue":e[7]||(e[7]=s=>o.tempProduct.price=s)},null,512),[[a,o.tempProduct.price]])])]),nt,t("div",at,[ct,n(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入產品描述","onUpdate:modelValue":e[8]||(e[8]=s=>o.tempProduct.description=s)},`\r
                    `,512),[[a,o.tempProduct.description]])]),t("div",rt,[ut,n(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入說明內容","onUpdate:modelValue":e[9]||(e[9]=s=>o.tempProduct.content=s)},`\r
                    `,512),[[a,o.tempProduct.content]])]),t("div",pt,[t("div",mt,[n(t("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":e[10]||(e[10]=s=>o.tempProduct.is_enabled=s)},null,512),[[U,o.tempProduct.is_enabled]]),ht])])])]),t("div",_t,[bt,t("button",{type:"button",class:"btn btn-primary",onClick:e[11]||(e[11]=(...s)=>c.saveProduct&&c.saveProduct(...s))}," 確認 ")])])])])}const gt=b(w,[["render",Pt]]),ft={props:["temp-Product","deleteProduct"]},vt={class:"modal-dialog"},$t={class:"modal-content border-0"},yt=t("div",{class:"modal-header bg-danger text-white"},[t("h5",{id:"delProductModalLabel",class:"modal-title"},[t("span",null,"刪除產品")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Mt={class:"modal-body"},kt={class:"text-danger"},Ut={class:"modal-footer"},wt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Vt(o,e,c,P,u,r){return d(),l("div",vt,[t("div",$t,[yt,t("div",Mt,[f(" 是否刪除 "),t("strong",kt,h(o.tempProduct.title),1),f(" 商品(刪除後將無法恢復)。 ")]),t("div",Ut,[wt,t("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=(...s)=>c.deleteProduct&&c.deleteProduct(...s))}," 確認刪除 ")])])])}const At=b(ft,[["render",Vt]]),{VITE_APP_URL:m,VITE_APP_PATH:_}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"silvia-hexschool",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0},Ct={data(){return{tempProduct:{},products:[],productModal:{},delProductModal:{},isNew:!1,isLoading:!1}},components:{ProductModal:gt,DelProductModal:At},methods:{getAllProducts(){this.$http.get(`${m}/api/${_}/admin/products/all`).then(o=>{this.products=o.data.products,console.log(o.data.products),this.isLoading=!1}).catch(o=>{console.log(o)})},deleteProduct(){this.$http.delete(`${m}/api/${_}/admin/product/${this.tempProduct.id}`).then(o=>{this.delProductModal.hide(),this.getAllProducts()}).catch(o=>{console.log(o)})},saveProduct(){this.isNew?this.$http.post(`${m}/api/${_}/admin/product`,{data:this.tempProduct}).then(o=>{this.productModal.hide(),this.getAllProducts()}).catch(o=>{console.log(o)}):this.$http.put(`${m}/api/${_}/admin/product/${this.tempProduct.id}`,{data:this.tempProduct}).then(o=>{this.productModal.hide(),this.getAllProducts()}).catch(o=>{console.log(o)})},checkAdmin(){this.$http.post(`${m}/api/user/check`).then(o=>{this.getAllProducts()}).catch(o=>{console.log(o),this.$router.push("/login")})},hide(){this.productModal.hide()},openModal(o,e){this.isNew=o==="create",o==="edit"?this.tempProduct={...e}:this.tempProduct={imagesUrl:[]},this.productModal=new g(document.querySelector("#productModal")),this.productModal.show()},openDeleteModal(o){this.tempProduct={...o},this.delProductModal=new g(document.querySelector("#delProductModal")),this.delProductModal.show()}},mounted(){const o=document.cookie.replace(/(?:(?:^|.*;\s*)hexschoolToken\s*=\s*([^;]*).*$)|^.*$/,"$1");this.$http.defaults.headers.common.Authorization=o,this.checkAdmin()}},Nt={class:"container"},Lt={class:"text-end mt-4"},Tt={class:"table mt-4"},Dt=t("thead",null,[t("tr",null,[t("th",{width:"120"},"分類"),t("th",null,"產品名稱"),t("th",{width:"120"},"原價"),t("th",{width:"120"},"售價"),t("th",{width:"100"},"是否啟用"),t("th",{width:"120"},"編輯")])],-1),Et={class:"text-end"},Bt={class:"text-end"},It={key:0,class:"text-success"},Rt={key:1},St={class:"btn-group"},qt=["onClick"],Ft=["onClick"],Ht={id:"productModal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},Ot={id:"delProductModal",ref:"delProductModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"};function xt(o,e,c,P,u,r){const s=v("product-modal"),p=v("del-product-modal");return d(),l("div",Nt,[t("div",Lt,[t("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=i=>r.openModal("create"))}," 建立新的產品 ")]),t("table",Tt,[Dt,t("tbody",null,[(d(!0),l(y,null,M(u.products,i=>(d(),l("tr",{key:i.id},[t("td",null,h(i.category),1),t("td",null,h(i.title),1),t("td",Et,h(i.origin_price),1),t("td",Bt,h(i.price),1),t("td",null,[i.is_enabled===1?(d(),l("span",It,"啟用")):(d(),l("span",Rt,"未啟用"))]),t("td",null,[t("div",St,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:k=>r.openModal("edit",i)}," 編輯 ",8,qt),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:k=>r.openDeleteModal(i)}," 刪除 ",8,Ft)])])]))),128))])]),t("div",Ht,[$(s,{"temp-product":u.tempProduct,"save-product":r.saveProduct,isNew:u.isNew},null,8,["temp-product","save-product","isNew"])]),t("div",Ot,[$(p,{"temp-product":u.tempProduct,"delete-product":r.deleteProduct},null,8,["temp-product","delete-product"])],512)])}const Gt=b(Ct,[["render",xt]]);export{Gt as default};
